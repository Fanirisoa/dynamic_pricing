#####################################################
###    Load both data.contract and data.ret   #######
#####################################################
load("DataPrice20092010.Rdata")

#####################################################
###                 Data set                  #######
#####################################################
#Data.N=Data.N2

Data.N=Data.N2[-c(506,1462,1638,1645),]


#####################################################
###         Parameters of the model           #######
#####################################################
###   Initial parameter  ####
##    w=para_h[1]; b=para_h[2]; a=para_h[3];  c= para_h[4]; neta=para_h[5] ; nu=para_h[6]; ro=para_h[7]

para_h<-c( 6.4945e-06 , 5.4045e-01  ,3.900e+02,  1.1031e-05, -5.0328e-03 , 1.9460e+02  ,9.974099e-01 )

para_h<-c( 6.4945e-06 , 5.4045e-01  ,3.750e+02,  1.1031e-05, -5.0328e-03 , 1.9460e+02  ,9.974099e-01 )

para_h<-c( 6.4945e-06 , 5.4045e-01  ,3.6359e+02,  1.1031e-05, -5.0328e-03 , 1.9460e+02  ,9.974099e-01 )

para_h<-c( 6.4945e-06 , 5.4045e-01  ,3.400e+02,  1.1031e-05, -5.0328e-03 , 1.9460e+02  ,9.974099e-01 )

para_h<-c( 6.4945e-06 , 5.4045e-01  ,3.450e+02,  1.1031e-05, -5.0328e-03 , 1.9460e+02  ,9.974099e-01 )




##para_h<-c(1.954353e-04,  8.108242e-02,  1.079682e+03,  4.849633e-05, -7.854745e-03,  1.040054e+02,  9.935264e-01) # 0.05048929

##para_h<-c(1.954353e-04,  8.508242e-02,  2.079682e+03,  4.849633e-05, -7.854745e-03,  1.007054e+02,  9.935264e-01)


#para_h<-c(4.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02,  9.84599e-01 )  ## RMSE2$rmse :0.04354643  RMSE3$rmse : 0.05756848
# 
# ##   solution  ####
# para_h<-c(1.016620e-05,  2.041894e-03,  3.317506e+03,  4.501851e-05, -7.465712e-03,  1.258399e+02,  9.945561e-01) 
# 
# para_h<-c(9.817584e-06 , 1.215612e-03 , 3.322312e+03 , 4.542147e-05, -7.531277e-03,  1.258401e+02,9.94599e-01 ) 
# 
# para_h=c(1.206116e-06,  2.305289e-03,  3.317425e+03,  4.902499e-05, -7.972150e-03,  1.258400e+02,9.94599e-01 ) 
# 
# para_h=c(2.234137e-06,  2.318400e-03,  3.317424e+03,  4.894911e-05, -7.955236e-03,  1.258397e+02,  9.978291e-01)
# 



############################################### 
###          Resultat Generale          #######
############################################### 
#para_h<-c(4.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02 )   ## RMSE2$rmse :0.05435837 RMSE3$rmse : 0.06742708

# time.taken
# Time difference of 41.26547 secs
# 
# # Solution
# $`par`
# [1]  9.427303e-06  2.051123e-03  3.317425e+03  4.725221e-05 -7.973112e-03  1.258399e+02  9.946611e-01
# 
# $value
# [1] 4706.226
# 
# $counts
# function gradient 
# 1021       NA 
# 
# $convergence
# [1] 0
# 
# $message
# NULL
# 
# # Standard error
# [1] 9.356137e-05 1.119981e-04 9.356927e-05 1.434307e-06 9.359197e-05 9.356968e-05 9.357352e-05
# 
# # RMSE
# > RMSE1$in
# [1] 0.03381406
# > RMSE2$out
# [1] 0.04287557
# > RMSE2$we
# [1] 0.03891758
# 
# > MPE
# [1] 1.166707
# > MAE
# [1] 1.210328
# > MAE2
# [1] 1.210328
# > Vrmse
# [1] 28.88739

# para_h<-c(4.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02,  9.84599e-01 )  ## RMSE2$rmse :0.04354643  RMSE3$rmse : 0.05756848
# > Sol
# $par
# [1]  5.247500e-06  1.902354e-03  3.317425e+03  4.880347e-05 -8.060528e-03  1.258397e+02  9.951130e-01
# 
# $value
# [1] 5422.216
# 
# $counts
# function gradient 
# 1671       NA 
# 
# $convergence
# [1] 0
# 
# $message
# NULL
# para_h<-c( 6.4945e-06 , 5.4045e-01  ,0,1,  1.1031e-05, -5.0328e-03 , 1.9460e+02  ,9.974099e-01 )
# 
# 
# > para_h
# [1]  6.494500e-06  5.404500e-01  3.635900e+02  1.103100e-05 -5.032800e-03  1.946000e+02  9.974099e-01
# 
# Time difference of 1.806757 mins
# > Sol
# $par
# [1]  2.792566e-06  5.609998e-01  3.979636e+02  1.062469e-05 -4.990155e-03  1.965254e+02  9.864396e-01
# 
# $value
# [1] 3309.685
# 
# $counts
# function gradient 
# 1718       NA 
# 
# $convergence
# [1] 0
# 
# $message
# NULL
# 
