#####################################################
###    Load both data.contract and data.ret   #######
#####################################################
load("DataPrice20092010.Rdata")

#####################################################
###                 Data set                  #######
#####################################################
#Data.N=Data.N2

Data.N=Data.N2[-c(506,1462,1638,1645),]
N_val = 2^12
#####################################################
###         Parameters of the model           #######
#####################################################
#   w=para_h[1]; b=para_h[2]; a=para_h[3];  c= para_h[4]; neta=para_h[5] ; nu=para_h[6] ; PI=para_h[7] ; ro=para_h[8]

###   Initial parameter  ####

### para_h<-c(3.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02, 1.632707e+00 ,  9.83599e-01 )  ## RMSE2$rmse :0.04287557  RMSE3$rmse : 0.05661406

### para_h<-c(3.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02, 1.1003707e+00 ,  9.83599e-01 )   ## RMSE2$rmse :0.04620022  RMSE3$rmse : 0.06100658 

##   solution  ####
### para_h<-c(9.876201e-06,  8.626756e-03,  3.317423e+03 , 4.491365e-05, -7.516695e-03 , 1.258370e+02,  1.097198e+00 , 9.962589e-01 )   

### para_h<-c(1.010747e-05,  2.282316e-03,  3.317425e+03,  4.514664e-05, -7.499894e-03,  1.258394e+02,  1.100010e+00,  9.945118e-01 ) 

para_h<-c(3.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02, 1.4003707e+00 ,  9.83599e-01 )   ## RMSE2$rmse :0.04620022  RMSE3$rmse : 0.06100658 





#para_h<-c(4.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02, 1.110707e+00 ,  9.84599e-01 )  ## RMSE2$rmse :0.04684522  RMSE3$rmse :  
#para_h<-c(4.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02, 1.100707e+00 ,  9.83599e-01 )  ## RMSE2$rmse :0.04617248  RMSE3$rmse :  
#para_h<-c(3.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02, 1.1003707e+00 ,  9.83599e-01 )   ## RMSE2$rmse :0.04620022  RMSE3$rmse : 0.06100658 
#para_h<-c(3.238940e-06 , 2.058376e-03  ,3.317425e+03 , 5.058743e-05, -8.281782e-03 , 1.2584e+02, 1.80707e+00 ,  9.83599e-01 )  ## RMSE2$rmse :0.1153094 RMSE3$rmse :  


############################################################
####                        RMSE                          ##
############################################################
## N_val = 2^11
## 3.927617 mins
## 0.06113377
## 0.05406446

## N_val = 2^12
## 8.771856 mins
## 0.05925612
## 0.05240393

## N_val = 2^13
## 8.771856 mins
## 0.05793751
## 0.0512378

## N_val = 2^14
## 51.29552 mins
## 0.05753171
## 0.05087892

## N_val = 2^15
## 2.483147 hours
## 0.05732707
## 0.05069795

## N_val = 2^16
## 16.46745 hours

