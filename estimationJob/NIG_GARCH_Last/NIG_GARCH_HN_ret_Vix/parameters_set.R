#####################################################
###    Load both data.contract and data.ret   #######
#####################################################
load("DataPrice20092010.Rdata")

#####################################################
###                 Data set                  #######
#####################################################
#Data.N=Data.N2

Data.N=Data.N2[-c(506,1462,1638,1645),]

#####################################################
###      Parameters of the silulation         #######
#####################################################
N= 200


#####################################################
###             date to considere             #######
#####################################################
index_ht = which(Data.returns$date == "2010-01-04")

index_vix = which(Data.ret$date == "2010-01-04")



#####################################################
###         Parameters of the model           #######
#####################################################
##   a0=para_h[1]; a1=para_h[2]; gama=para_h[3];  b1= para_h[4] ;  lamda0= para_h[5] ; ro=para_h[6]
 

###   Initial parameter  ####``
###   Initial parameter  para_h<-c() set up the parameters of the volatility  ####
para_h<-c(1.180234e-12, 1.547729e-06, 4.550518e+02, 6.500111e-01 ,8.596182e+00, 9.646967e-01)
          
### para_h<-c(3.313135e-15, 1.366366e-06, 4.274284e+02, 7.324341e-01, 8.531595e+00, 9.95507e-01)  ## RMSE2$rmse : 0.0154167 ## RMSE3$rmse : 0.01615634
### para_h<-c(3.788371e-13, 1.520721e-06, 4.649298e+02, 6.619980e-01, 4.400007e-01, 9.646967e-01)  ## RMSE2$rmse : 0.01082776 ## RMSE3$rmse : 0.03113633
### para_h<-c(3.788371e-13, 1.520721e-06, 4.649298e+02, 6.619980e-01, 6.400007e-01, 9.646967e-01)  ## RMSE2$rmse : 0.0154167 ## RMSE3$rmse : 0.03113633
### para_h<-c(1.905978e-08, 1.522443e-06, 4.642720e+02, 6.620030e-01, 6.399963e-01, 9.646983e-01) ## 0.01083887

#para_h=c(1.854299e-04, 3.345238e-04 ,0.142406e+01 ,1.124012e-03 ,6.573458e-01)
#para_h<-c( 5.881028e-07,  1.506407e-06,  4.550518e+02,  6.500114e-01,  8.596182e+00)

###   Initial parameter  para_distribution<-c() set up the parameters of the distribution   ####
### alpha=para_distribution[1];  beta=para_distribution[2];  delta=para_distribution[3];  mu=para_distribution[4];


###para_distribution=c(1.269943539, -0.002488772,  1.620073612,  2.088112106)

###para_distribution=c(1.269944e+00, -2.488772e-03,  1.620074e+00,  2.088112e+00 )

para_distribution=c(8.478143e-01, -1.399045e-01,  1.973412e+00, 2.303577e+00)

###para_distribution<-c(5.21, 1.397610234,   0.007012446,  -0.286886696)
###para_distribution<-c(2.237095e+01, -1.047143e+01,  7.135328e-03,  8.048087e-04)

para_M = c(para_distribution,para_h)

# Time difference of 23.90931 secs
# > 
#   > Sol
# $par
# [1] 5.209999e+00 4.236129e+00 7.010943e-03 5.401264e+00 2.124409e-06 1.518744e-06 4.578959e+02 6.555648e-01 8.596186e+00 9.646951e-01
# 
# $value
# [1] 6868.731
# 
# $counts
# function gradient 
# 559       NA 
# 
# $convergence
# [1] 0
# 
# $message
# NULL
# 
# > para_M1<-Sol$par
# > para_M
# [1]  5.210000e+00  1.397610e+00  7.012446e-03 -2.868867e-01  1.180234e-12  1.547729e-06  4.550518e+02  6.500111e-01  8.596182e+00  9.646967e-01
# > para_M1
# [1] 5.209999e+00 4.236129e+00 7.010943e-03 5.401264e+00 2.124409e-06 1.518744e-06 4.578959e+02 6.555648e-01 8.596186e+00 9.646951e-01
# > 

runif(10, 1.0, 7.5)
# 
# > time.taken
# Time difference of 1.379159 mins
# > 
#   > Sol
# $par
# [1]  8.478139e-01 -1.399045e-01  1.973412e+00  2.303577e+00  1.449641e-05  3.328821e-07  4.645710e+02  9.167134e-01  8.721683e+00  8.965085e-01
# 
# $value
# [1] 2515.587
# 
# $counts
# function gradient 
# 2111       NA 
# 
# $convergence
# [1] 0
# 
# $message
# NULL
# 
# > para_M1<-Sol$par
# > para_M
# [1]  1.269944e+00 -2.488772e-03  1.620074e+00  2.088112e+00  1.180234e-12  1.547729e-06  4.550518e+02  6.500111e-01  8.596182e+00  9.646967e-01
# > para_M1
# [1]  8.478139e-01 -1.399045e-01  1.973412e+00  2.303577e+00  1.449641e-05  3.328821e-07  4.645710e+02  9.167134e-01  8.721683e+00  8.965085e-01
# > ######################
# 
# > time.taken
# Time difference of 1.391784 mins
# > 
#   > Sol
# $par
# [1]  6.215675e-01 -3.771833e-01  1.963699e+00  2.339275e+00  3.042748e-05  7.941719e-07  4.649927e+02  8.084379e-01  9.593983e+00  9.800957e-01
# 
# $value
# [1] 1569.329
# 
# $counts
# function gradient 
# 2133       NA 
# 
# $convergence
# [1] 0
# 
# $message
# NULL
# 
# > para_M1<-Sol$par
# > para_M
# [1]  8.478143e-01 -1.399045e-01  1.973412e+00  2.303577e+00  1.180234e-12  1.547729e-06  4.550518e+02  6.500111e-01  8.596182e+00  9.646967e-01
# > para_M1
# [1]  6.215675e-01 -3.771833e-01  1.963699e+00  2.339275e+00  3.042748e-05  7.941719e-07  4.649927e+02  8.084379e-01  9.593983e+00  9.800957e-01
# > ############################################################
# > ####